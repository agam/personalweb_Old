<!DOCTYPE html>
<html lang="en">

<!-- TODO(agam): Get rid of this header/footer duplication ! -->
<head>
    <meta charset="utf-8" />
    <title>Posterous Browsing</title>
    <meta name="description" content="Table of Contents  and browsing for Agam's Posterous">

    <link href="/static/images/favicon.ico" rel="shortcut icon" />
    <link href="/static/css/css-mini-reset.css" rel="stylesheet" type="text/css" />
    <link href='http://fonts.googleapis.com/css?family=Crafty+Girls|Droid+Sans|Calligraffitti' rel='stylesheet' type='text/css'>
    <link href="/static/css/main.css" rel="stylesheet" type="text/css" />

    <!-- Load jquery from Google -->
    <script src="https://www.google.com/jsapi?key=ABQIAAAAnjiQb--VssnWxB8gJJANHRT8vATYeMg6i0IPOit6GndEekLi2xQ4F_cMnVxB8nQzMgqGJOUYavreNw" type="text/javascript"></script>
    <script language="Javascript" type="text/javascript">
        google.load("jquery", "1.6.2");
        google.load("jqueryui", "1.8.16");

        var forward_prev = 0;
        var forward_next = 0;

        var end_prev = 0;
        var end_next = 0;

        var api_token = 'BouCofdeoIrIfbpzqiBfroAxfhIiJjxJGeyGgckqhpvazirtlfIzBeIunGfmeyewlCJgpIBjfCvenGjgjezxzfDmrAdbCGouEhcc';

        function init_posterous() {
            $("#status").hide();

            console.log("Calling beginning posts");
            get_beginning_posts(0);
            console.log("Calling Ending posts");
            get_end_posts(0);
        }

        function populate_posts(divid, data) {
            console.log("Populating posts");
            $(divid).html("<ul>");
            $.each(data, function(index, post) {
                    if (post) {
                        $(divid).append("<li>" + post.post_title + "  [<a href=\"" + post.post_url + "\">Open</a>]</li>");
                    }
                    });
            $(divid).append("</ul>");
            $(divid + " li").mouseover(function() {
                    $(this).animate({'height': 70}, 'slow');
                    });
            $(divid + " li").mouseout(function() {
                    $(this).animate({'height': 20}, 'slow');
            });

        }

        function get_beginning_posts(postid) {
            console.log("Getting beginning posts");
            $("#status").fadeIn("slow");
            $.getJSON('http://agambrahma.appspot.com/posterous/getpagefront',
                    function(data) {
                        console.log("Got back json ...");
                        populate_posts("#beginningpostslist", data);
                        });
                    $("#status").fadeOut("slow");
        }

        function get_end_posts(postid) {
            $("#status").fadeIn("slow");
            $.getJSON('http://agambrahma.appspot.com/posterous/getpageback',
                    function(data) {
                        populate_posts("#endpostslist", data);
                        });
                    $("#status").fadeOut("slow");
        }

        google.setOnLoadCallback(init_posterous);
    </script>
    <!-- custom css for this page's layout -->
    <style type="text/css">
    </style>

</head>

<body>
    <h1>A better posterous browser</h1>

    <div id="status"><img src="/static/images/loading.gif" /></div>
    <div id="postheader"> 
        <h2>Posterous content indexed from the beginning and from the end</h2>
        <p>(Each page has 20 posts, content derived from <a href="http://agambrahma.posterous.com">agambrahma.posterous.com</a>, but pages here do not correspond to pages there)
    </div>

    <div id="beginningposts">
        <p><b>Latest</b>
        <div id="beginningpostslist"></div>
    </div>

    <div id="endposts">
        <p><b>Oldest</b>
        <div id="endpostslist"></div>
    </div>

    <footer>
    <p><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-nd/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported License</a>.
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-16612682-3']);
        _gaq.push(['_setDomainName', 'appengine.appspot.com']);
        _gaq.push(['_setAllowHash', false]);
        _gaq.push(['_trackPageview']);

        (function() {
         var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
         ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
         var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
         })();
    </script>
    </footer>
</body>
</html>
